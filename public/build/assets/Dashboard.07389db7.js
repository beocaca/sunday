import{r as G,C as S,k as x,o as m,a as C,w as n,b as t,j as l,g as u,t as p,u as f,d as h,e as g,n as D,F as y,i as k,v as $,q as K,K as H,B as Q}from"./app.3ce0088d.js";import{_ as R}from"./AppLayout.8ec9311d.js";import{B as O,P as L,L as X,a as Y,s as Z}from"./Viewer.be791c8f.js";import{S as ee}from"./controls.94abbb5d.js";import{J as T}from"./DialogModal.7ab1b676.js";import{J as I}from"./Button.2e6d22da.js";import{t as te,f as A}from"./index.590f4998.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./ConfirmationModal.60162698.js";import"./Modal.09035abd.js";import"./DangerButton.6c27673a.js";import"./SecondaryButton.9fb1985c.js";import"./ItemGroupCell.b94df27d.js";var oe="/build/assets/undraw_a_day_at_the_park.31663b51.svg",se="/build/assets/undraw_empty.23b3a35d.svg",ae="/build/assets/undraw_game_day_ucx9.b515c44a.svg";const ne={class:""},ie={class:"flex flex-col mx-auto max-w-8xl sm:pr-6 lg:pr-8 md:flex-row"},le={class:"pt-12 w-100 md:w-7/12 lg:w-8/12 md:mx-4"},re={class:"flex flex-col justify-between mx-2 md:flex-row md:mr-2 md:ml-0"},de=t("span",{class:"pl-2 text-lg font-bold"}," Lineup ",-1),ce={class:"flex items-center"},me={class:"w-40 mr-2"},ue={slot:"singleLabel","slot-scope":"props"},pe={class:"option__title"},he=t("i",{class:"mr-2 fa fa-briefcase"},null,-1),fe={slot:"option","slot-scope":"props"},_e={class:"option__desc"},be={class:"option__title"},ge=t("i",{class:"mr-2 fa fa-briefcase"},null,-1),ye={class:"h-10 bg-purple-700 rounded-lg controls"},ke=["onClick"],ve=t("div",{class:"w-full mx-auto prose prose-xl text-center"},[t("img",{src:oe,class:"w-4/12 mx-auto"}),t("p",{class:"mt-4"},"All tasks done. take a rest")],-1),we={class:"pt-12 w-100 md:w-5/12 lg:w-4/12 md:ml-4"},Se=t("span",{class:"ml-2 text-3xl font-bold"}," Tools ",-1),xe={class:"mt-5 section-card committed"},Ce={class:"section-card committed"},De={class:"flex justify-between font-bold text-white bg-blue-400"},$e=t("span",null," Links ",-1),Oe=t("i",{class:"fa fa-plus"},null,-1),Le=[Oe],Te={class:"text-gray-600 bg-blue-400 body"},Ie={class:"section-card committed"},Ae={class:"flex justify-between font-bold text-white bg-blue-400"},Fe=t("span",null," Agenda ",-1),Ve=u(" Go to Planner "),Be={class:"text-gray-600 bg-blue-400 body"},je={class:"mr-2 font-bold"},Pe={class:"capitalize"},Me=u(" Today's Standup "),Ue={class:"checkbox-label"},We=["onChange","id","onUpdate:modelValue"],Ee={class:"font-bold"},Ne=u(" Complete Day "),qe={class:"prose prose-xl text-center"},Je=t("div",null,[t("img",{src:ae,alt:"",class:"w-6/12 mx-auto"})],-1),ze=t("h2",{class:"text-center"},"Welcome to Daily.",-1),Ge=t("div",{class:"mb-5"}," Create tasks, track the time it takes to get it done, link your promodoros and be more productive! ",-1),Ke={class:"text-center"},He=u(" Let's start! "),rt={__name:"Dashboard",props:{boards:{type:Array,default(){return[]}},boardTypes:{type:Array,default(){return[]}},boardTemplates:{type:Array,default(){return[]}},todo:{type:[Array,Object],default(){return[]}},agenda:{type:[Array,Object],default(){return[]}},commitDate:{type:String,required:!0},standup:{type:Array,default(){return[]}},links:{type:Array,default(){return[]}},committed:{type:[Array,Object],default(){return[]}},settings:{type:Object,default(){return{}}},user:{type:Object,required:!0}},setup(r){const d=r,c=G({modes:["inbox","daily"],selectedStage:"",modeSelected:"inbox",promodoroColor:"red",standupSummary:[],localCommitDate:new Date,isLoading:!1,showWelcomeScreen:!1,isStandupOpen:!1,isLinkFormOpen:!1,linkData:{},tracker:null});watch(c.localCommitDate,(e,o)=>{o&&e.toISOString().slice(0,10)!=o.toISOString().slice(0,10)&&U()}),computed(()=>d.todo.filter(e=>e.done).length);const F=computed(()=>["daily","inbox"].includes(c.modeSelected)),V=computed(()=>["daily","committed"].includes(c.modeSelected)),B=computed(()=>S.exports.uniq(this.todo.map(e=>e.stage))),j=computed(()=>{const e=c.selectedStage?d.todo.filter(o=>o.stage==c.selectedStage):d.todo.filter(o=>o);return S.exports.orderBy(e,["priority","stage","title"])});onMounted(()=>{!d.standup.length&&d.todo.length&&(c.standupSummary={...d.todo},c.isStandupOpen=!0),c.showWelcomeScreen=!Boolean(Number(d.settings.hide_welcome_screen)),c.showWelcomeScreen&&fireworks()}),P();function P(){let e=new Date;this.commitDate&&(e=this.commitDate.split("-"),e=te(new Date(e[0],e[1]-1,e[2]))),this.localCommitDate=e}function M(){this.isLoading=!0;const e=A(Z(new Date,1),"yyyy-MM-dd"),o=A(new Date,"yyyy-MM-dd");let i=this.todo.filter(a=>a.done);i=i.map(a=>(a.commit_date=e,a)),i.forEach(async a=>{await this.updateItem(a)}),this.updateDaily(o),this.isStandupOpen=!1,this.isLoading=!1,this.$inertia.reload({preserveScroll:!0,preserveState:!0})}function U(){const e=`?commit-date=${this.localCommitDate.toISOString().slice(0,10)}`;this.$inertia.replace(`/${e}`,{only:["committed"],preserveScroll:!0,preserveState:!0})}function _(e){const o=e.id?"PUT":"POST",i=e.id?`/${e.id}`:"";axios({url:`/items${i}`,method:o,data:e}).then(()=>{this.$inertia.reload({preserveScroll:!0,preserveState:!0});const a=this.todo.findIndex(s=>e.id==s.id);return this.todo.splice(a,1),e.done&&(this.todo.length?this.celebrate():this.fireworks()),!0})}function W(e){this.linkData=e,this.isLinkFormOpen=!0}function E(){this.closeLinkForm(),this.$inertia.reload({preserveScroll:!0})}function N(e){this.$refs.Promodoro.setTask(e)}function q(){this.tracker=null,axios("/api/items/todos").then(({data:e})=>{this.todo=e})}function v(e,o){const i=this[o].findIndex(a=>a.id==e.id);this[o].splice(i,1)}function J(){return axios({url:"/api/automations/createTaskFromCalendar/run",method:"POST"}).then(({data:e})=>{e.forEach(o=>{Echo.private(`automations.${o.id}`).listen("AutomationCompleted",i=>{console.log(i),this.$notify({type:"success",title:"Automation Completed",message:"Updated"}),this.$inertia.reload({preserveScroll:!0})})})})}function w(){axios({url:"/api/settings",method:"POST",data:{hide_welcome_screen:!0}}).then(({data:e})=>{this.showWelcomeScreen=!1,this.$inertia.reload({preserveScroll:!0})})}function z(){}return(e,o)=>{const i=x("multiselect"),a=x("inertia-link");return m(),C(R,{boards:r.boards},{default:n(()=>[t("div",ne,[t("div",ie,[t("div",le,[t("div",re,[de,t("div",ce,[t("div",me,[l(i,{modelValue:e.selectedStage,"onUpdate:modelValue":o[0]||(o[0]=s=>e.selectedStage=s),ref:"input","show-labels":!1,placeholder:"Filter by stage",options:f(B),class:"w-full"},{default:n(()=>[t("template",ue,[t("span",pe,[he,u(" "+p(d.option),1)])]),t("template",fe,[t("div",_e,[t("span",be,[ge,u(" "+p(d.option),1)])])])]),_:1},8,["modelValue","options"])]),t("div",ye,[(m(!0),h(y,null,g(e.modes,s=>(m(),h("button",{key:s,onClick:b=>e.modeSelected=s,class:D([{"bg-purple-400":s==e.modeSelected},"h-full px-8 text-white capitalize rounded-lg"])},p(s),11,ke))),128))])])]),k(l(O,{title:"Commited",tasks:r.committed,onItemDeleted:o[2]||(o[2]=s=>v(s,"committed")),onUpdateItem:_},{default:n(()=>[t("template",null,[e.localCommitDate?(m(),C(ee,{key:0,modelValue:e.localCommitDate,"onUpdate:modelValue":o[1]||(o[1]=s=>e.localCommitDate=s)},null,8,["modelValue"])):K("",!0)])]),_:1},8,["tasks"]),[[$,f(V)]]),k(l(O,{title:"To Do","allow-add":!0,boards:r.boards,tasks:f(j),tracker:e.tracker,onUpdateItem:_,onItemDeleted:o[3]||(o[3]=s=>v(s,"todo")),onItemClicked:N},H({_:2},[r.committed.length?{name:"empty",fn:n(()=>[ve])}:{name:"empty",fn:n(()=>[t("div",{class:"w-full mx-auto prose prose-xl text-center"},[t("img",{src:se,class:"w-4/12 mx-auto"}),t("small",{class:"mt-4 text-gray-400"},[u(" Nothing to do. Add new tasks from here or mark in your "),t("a",{href:"#",onClick:z},"boards"),u(" as todo")])])])}]),1032,["boards","tasks","tracker"]),[[$,f(F)]])]),t("div",we,[Se,t("div",xe,[t("div",{class:D(`bg-${e.promodoroColor} text-gray-600 font-bold px-0`)},[l(L,{ref_key:"Promodoro",ref:L,settings:r.settings,tracker:e.tracker,"timer-color":e.promodoroColor,tasks:r.todo,onStopped:q},null,8,["settings","tracker","timer-color","tasks"])],2)]),t("div",Ce,[t("header",De,[$e,t("button",{class:"text-white bg-transparent",onClick:o[4]||(o[4]=s=>e.isLinkFormOpen=!e.isLinkFormOpen)},Le)]),t("div",Te,[l(X,{links:r.links,onEdit:W},null,8,["links"])])]),t("div",Ie,[t("header",Ae,[Fe,t("div",null,[t("i",{class:"inline-block ml-4 cursor-pointer fa fa-robot",onClick:J}),l(a,{class:"text-white bg-transparent",href:"/planner"},{default:n(()=>[Ve]),_:1})])]),t("div",Be,[(m(!0),h(y,null,g(r.agenda,s=>(m(),h("div",{class:"p-2 text-white rounded-md cursor-pointer hover:bg-blue-500",key:`event-${s.id}`},[t("span",je,p(s.time),1),t("span",Pe,p(s.title),1)]))),128))])])])]),l(T,{show:e.isStandupOpen,onClose:o[6]||(o[6]=s=>e.isStandupOpen=!1)},{title:n(()=>[Me]),content:n(()=>[t("div",null,[(m(!0),h(y,null,g(e.standupSummary,s=>(m(),h("p",{key:`task-${s.id}`},[t("label",Ue,[k(t("input",{type:"checkbox",onChange:b=>_(s),name:"",id:s.id,"onUpdate:modelValue":b=>s.done=b},null,40,We),[[Q,s.done]]),t("span",Ee," ["+p(s.stage)+"] ",1),t("span",null,p(s.title),1)])]))),128))])]),footer:n(()=>[l(I,{onClick:o[5]||(o[5]=s=>M())},{default:n(()=>[Ne]),_:1})]),_:1},8,["show"]),l(T,{show:e.showWelcomeScreen,onClose:w},{content:n(()=>[t("div",qe,[Je,ze,Ge,t("div",Ke,[l(I,{onClick:o[7]||(o[7]=s=>w())},{default:n(()=>[He]),_:1})])])]),_:1},8,["show"]),l(Y,{"record-data":e.linkData,"is-open":e.isLinkFormOpen,onSaved:E,onCancel:o[8]||(o[8]=s=>e.isLinkFormOpen=!1)},null,8,["record-data","is-open"])])]),_:1},8,["boards"])}}};export{rt as default};
